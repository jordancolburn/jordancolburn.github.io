<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grant's Math Game!</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      color: #333;
    }

    h1 {
      color: white;
      font-size: 2.5em;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
      margin-bottom: 5px;
    }

    .subtitle {
      color: #ffd700;
      font-size: 1.2em;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .score-bar {
      display: flex;
      gap: 30px;
      margin-bottom: 20px;
    }

    .score-box {
      background: white;
      border-radius: 15px;
      padding: 10px 25px;
      font-size: 1.3em;
      font-weight: bold;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .score-box span { color: #764ba2; }

    .game-card {
      background: white;
      border-radius: 25px;
      padding: 35px;
      width: 100%;
      max-width: 600px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      text-align: center;
    }

    .equation {
      font-size: 3em;
      font-weight: bold;
      color: #4a4a4a;
      margin: 20px 0;
      letter-spacing: 5px;
    }

    .equation .operator {
      color: #e74c3c;
      margin: 0 10px;
    }

    .answer-section {
      margin: 25px 0;
    }

    .answer-input {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      font-size: 2em;
      text-align: center;
      width: 200px;
      padding: 10px;
      border: 4px solid #764ba2;
      border-radius: 15px;
      outline: none;
      color: #333;
    }

    .answer-input:focus {
      border-color: #ffd700;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    }

    .submit-btn {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      font-size: 1.5em;
      padding: 12px 40px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      margin-top: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .submit-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }

    .submit-btn:active {
      transform: scale(0.98);
    }

    .message {
      font-size: 1.8em;
      font-weight: bold;
      margin: 15px 0;
      min-height: 50px;
    }

    .message.correct {
      color: #27ae60;
      animation: bounce 0.6s ease;
    }

    .message.wrong {
      color: #e74c3c;
      animation: shake 0.5s ease;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      30% { transform: translateY(-20px); }
      60% { transform: translateY(-10px); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20% { transform: translateX(-15px); }
      40% { transform: translateX(15px); }
      60% { transform: translateX(-10px); }
      80% { transform: translateX(10px); }
    }

    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 999;
    }

    .confetti {
      position: absolute;
      width: 12px;
      height: 12px;
      border-radius: 2px;
      animation: confetti-fall 2s ease-out forwards;
    }

    @keyframes confetti-fall {
      0% { opacity: 1; transform: translateY(0) rotate(0deg); }
      100% { opacity: 0; transform: translateY(100vh) rotate(720deg); }
    }

    /* Math Tools Section */
    .tools-section {
      background: #f8f4ff;
      border-radius: 20px;
      padding: 20px;
      margin-top: 20px;
      width: 100%;
      max-width: 600px;
    }

    .tools-title {
      font-size: 1.4em;
      color: #764ba2;
      margin-bottom: 15px;
    }

    .tools-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    .tool-btn {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      font-size: 1em;
      padding: 10px 18px;
      border: 3px solid #764ba2;
      background: white;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      color: #333;
    }

    .tool-btn:hover {
      background: #764ba2;
      color: white;
    }

    .tool-btn.active {
      background: #764ba2;
      color: white;
    }

    .tool-area {
      margin-top: 15px;
      min-height: 60px;
    }

    /* Number Line */
    .number-line {
      overflow-x: auto;
      padding: 15px 5px;
      background: white;
      border-radius: 12px;
      margin-top: 10px;
    }

    .number-line-inner {
      display: flex;
      align-items: center;
      gap: 2px;
      min-width: max-content;
      padding: 5px;
    }

    .nl-tick {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 0.7em;
      color: #999;
      cursor: pointer;
      padding: 2px 1px;
    }

    .nl-tick.major {
      font-size: 0.85em;
      color: #764ba2;
      font-weight: bold;
    }

    .nl-tick .line {
      width: 2px;
      height: 15px;
      background: #ccc;
    }

    .nl-tick.major .line {
      height: 25px;
      background: #764ba2;
    }

    /* Scratch Pad */
    .scratch-pad {
      background: white;
      border-radius: 12px;
      padding: 15px;
      margin-top: 10px;
    }

    .scratch-pad textarea {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      font-size: 1.2em;
      width: 100%;
      height: 120px;
      border: 2px dashed #ccc;
      border-radius: 10px;
      padding: 10px;
      resize: none;
      outline: none;
      color: #333;
    }

    .scratch-pad textarea:focus {
      border-color: #764ba2;
    }

    /* Counter */
    .counter-tool {
      background: white;
      border-radius: 12px;
      padding: 15px;
      margin-top: 10px;
      text-align: center;
    }

    .counter-display {
      font-size: 2.5em;
      font-weight: bold;
      color: #764ba2;
      margin: 10px 0;
    }

    .counter-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .counter-btn {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      font-size: 1.1em;
      padding: 8px 18px;
      border: 3px solid #764ba2;
      background: white;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.15s;
      color: #333;
    }

    .counter-btn:hover {
      background: #764ba2;
      color: white;
    }

    /* Base Ten Blocks */
    .blocks-tool {
      background: white;
      border-radius: 12px;
      padding: 15px;
      margin-top: 10px;
    }

    .blocks-tool p {
      color: #888;
      margin-bottom: 10px;
    }

    .blocks-controls {
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    .block-add-btn {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      font-size: 0.95em;
      padding: 8px 14px;
      border: 3px solid #764ba2;
      background: white;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.15s;
      color: #333;
    }

    .block-add-btn:hover {
      background: #764ba2;
      color: white;
    }

    .blocks-display {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: flex-end;
      min-height: 80px;
      padding: 10px;
      background: #f8f4ff;
      border-radius: 10px;
      border: 2px dashed #ccc;
    }

    .blocks-total {
      text-align: center;
      font-size: 1.8em;
      font-weight: bold;
      color: #764ba2;
      margin-top: 10px;
    }

    .block-hundred {
      width: 60px;
      height: 60px;
      background: #e74c3c;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.85em;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }

    .block-ten {
      width: 20px;
      height: 60px;
      background: #3498db;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.7em;
      writing-mode: vertical-rl;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }

    .block-one {
      width: 20px;
      height: 20px;
      background: #2ecc71;
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.65em;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }

    /* Hint */
    .hint-area {
      background: white;
      border-radius: 12px;
      padding: 15px;
      margin-top: 10px;
      font-size: 1.2em;
      color: #555;
    }

    .stars {
      margin-top: 10px;
    }

    .star {
      font-size: 2em;
      display: inline-block;
      animation: star-pop 0.4s ease;
    }

    @keyframes star-pop {
      0% { transform: scale(0); }
      70% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }

    .next-btn {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      font-size: 1.3em;
      padding: 12px 35px;
      background: #27ae60;
      color: white;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      margin-top: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      transition: transform 0.2s;
    }

    .next-btn:hover {
      transform: scale(1.05);
    }

    .difficulty-section {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 15px;
    }

    .diff-btn {
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      font-size: 1em;
      padding: 8px 20px;
      border: 3px solid white;
      background: transparent;
      color: white;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .diff-btn:hover, .diff-btn.active {
      background: white;
      color: #764ba2;
    }

    .footer {
      margin-top: 30px;
      color: rgba(255,255,255,0.8);
      font-size: 1em;
      text-align: center;
    }
  </style>
</head>
<body>

  <h1>Grant's Math Game!</h1>
  <p class="subtitle">Made by Grant, age 7</p>

  <div class="difficulty-section">
    <button class="diff-btn active" onclick="setDifficulty('easy')">Easy</button>
    <button class="diff-btn" onclick="setDifficulty('medium')">Medium</button>
    <button class="diff-btn" onclick="setDifficulty('hard')">Hard</button>
  </div>

  <div class="score-bar">
    <div class="score-box">Score: <span id="score">0</span></div>
    <div class="score-box">Streak: <span id="streak">0</span></div>
  </div>

  <div class="game-card">
    <div class="equation" id="equation"></div>

    <div class="answer-section">
      <input type="number" class="answer-input" id="answerInput" placeholder="?" autofocus>
      <br>
      <button class="submit-btn" id="submitBtn" onclick="checkAnswer()">Check Answer!</button>
    </div>

    <div class="message" id="message"></div>
    <div class="stars" id="stars"></div>

    <button class="next-btn" id="nextBtn" style="display:none;" onclick="newProblem()">Next Problem!</button>
  </div>

  <!-- Math Tools -->
  <div class="tools-section">
    <div class="tools-title">Math Tools</div>
    <div class="tools-grid">
      <button class="tool-btn" onclick="toggleTool('numberline')">Number Line</button>
      <button class="tool-btn" onclick="toggleTool('blocks')">Base Ten Blocks</button>
      <button class="tool-btn" onclick="toggleTool('counter')">Counter</button>
      <button class="tool-btn" onclick="toggleTool('scratch')">Scratch Pad</button>
      <button class="tool-btn" onclick="toggleTool('hint')">Hint</button>
    </div>
    <div class="tool-area" id="toolArea"></div>
  </div>

  <div class="confetti-container" id="confetti"></div>

  <div class="footer">
    This game was made by a 7 year old named Grant!
  </div>

  <script>
    let currentAnswer = 0;
    let num1 = 0;
    let num2 = 0;
    let operator = '+';
    let score = 0;
    let streak = 0;
    let difficulty = 'easy';
    let counterValue = 0;
    let activeTool = null;

    function setDifficulty(level) {
      difficulty = level;
      document.querySelectorAll('.diff-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      newProblem();
    }

    function getMaxNumber() {
      if (difficulty === 'easy') return 100;
      if (difficulty === 'medium') return 500;
      return 1000;
    }

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function newProblem() {
      const max = getMaxNumber();
      const ops = ['+', '-'];
      operator = ops[randomInt(0, ops.length - 1)];

      if (operator === '+') {
        num1 = randomInt(1, max);
        num2 = randomInt(1, max - num1);
        currentAnswer = num1 + num2;
      } else if (operator === '-') {
        num1 = randomInt(2, max);
        num2 = randomInt(1, num1 - 1);
        currentAnswer = num1 - num2;
      }

      document.getElementById('equation').innerHTML =
        `${num1} <span class="operator">${operator}</span> ${num2} = ?`;

      document.getElementById('answerInput').value = '';
      document.getElementById('answerInput').disabled = false;
      document.getElementById('message').textContent = '';
      document.getElementById('message').className = 'message';
      document.getElementById('stars').innerHTML = '';
      document.getElementById('nextBtn').style.display = 'none';
      document.getElementById('submitBtn').style.display = 'inline-block';
      document.getElementById('answerInput').focus();

      counterValue = 0;
      if (activeTool) toggleTool(activeTool);
      activeTool = null;
      document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('toolArea').innerHTML = '';
    }

    function checkAnswer() {
      const userAnswer = parseInt(document.getElementById('answerInput').value);

      if (isNaN(userAnswer)) {
        document.getElementById('message').textContent = 'Type a number first!';
        document.getElementById('message').className = 'message wrong';
        return;
      }

      if (userAnswer === currentAnswer) {
        streak++;
        score += (streak >= 3 ? 2 : 1);
        document.getElementById('score').textContent = score;
        document.getElementById('streak').textContent = streak;

        document.getElementById('message').textContent = 'Good job! üéâ';
        document.getElementById('message').className = 'message correct';

        let starHTML = '';
        const starCount = Math.min(streak, 5);
        for (let i = 0; i < starCount; i++) {
          starHTML += `<span class="star" style="animation-delay:${i * 0.15}s">‚≠ê</span>`;
        }
        document.getElementById('stars').innerHTML = starHTML;

        document.getElementById('equation').innerHTML =
          `${num1} <span class="operator">${operator}</span> ${num2} = ${currentAnswer}`;
        document.getElementById('answerInput').disabled = true;
        document.getElementById('submitBtn').style.display = 'none';
        document.getElementById('nextBtn').style.display = 'inline-block';
        document.getElementById('nextBtn').focus();

        launchConfetti();
      } else {
        streak = 0;
        document.getElementById('streak').textContent = streak;
        document.getElementById('message').textContent = 'Try again! You got this!';
        document.getElementById('message').className = 'message wrong';
        document.getElementById('answerInput').value = '';
        document.getElementById('answerInput').focus();
      }
    }

    function launchConfetti() {
      const container = document.getElementById('confetti');
      container.innerHTML = '';
      const colors = ['#e74c3c', '#3498db', '#2ecc71', '#f39c12', '#9b59b6', '#1abc9c', '#ffd700'];

      for (let i = 0; i < 50; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti';
        piece.style.left = Math.random() * 100 + '%';
        piece.style.top = '-10px';
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.animationDelay = Math.random() * 0.5 + 's';
        piece.style.animationDuration = (1.5 + Math.random()) + 's';
        container.appendChild(piece);
      }

      setTimeout(() => { container.innerHTML = ''; }, 3000);
    }

    // Math Tools
    function toggleTool(tool) {
      const area = document.getElementById('toolArea');
      document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));

      if (activeTool === tool) {
        activeTool = null;
        area.innerHTML = '';
        return;
      }

      activeTool = tool;
      event.target.classList.add('active');

      if (tool === 'numberline') showNumberLine();
      else if (tool === 'blocks') showBlocks();
      else if (tool === 'counter') showCounter();
      else if (tool === 'scratch') showScratchPad();
      else if (tool === 'hint') showHint();
    }

    function showNumberLine() {
      const area = document.getElementById('toolArea');
      const max = Math.min(Math.max(num1, num2, currentAnswer) + 20, 1020);
      const step = max <= 120 ? 1 : (max <= 220 ? 5 : 10);
      const majorEvery = max <= 120 ? 10 : (max <= 220 ? 50 : 100);

      let html = '<div class="number-line"><div class="number-line-inner">';
      for (let i = 0; i <= max; i += step) {
        const isMajor = i % majorEvery === 0;
        html += `<div class="nl-tick ${isMajor ? 'major' : ''}">
          ${isMajor ? i : ''}<div class="line"></div>
        </div>`;
      }
      html += '</div></div>';
      html += '<p style="margin-top:8px;font-size:0.9em;color:#888;">Scroll left and right to see more numbers!</p>';
      area.innerHTML = html;
    }

    let blocksHundreds = 0;
    let blocksTens = 0;
    let blocksOnes = 0;

    function showBlocks() {
      blocksHundreds = 0;
      blocksTens = 0;
      blocksOnes = 0;
      const area = document.getElementById('toolArea');
      area.innerHTML = `
        <div class="blocks-tool">
          <p>Tap buttons to add blocks, tap a block to remove it!</p>
          <div class="blocks-controls">
            <button class="block-add-btn" onclick="addBlock('hundred')">+ Hundred</button>
            <button class="block-add-btn" onclick="addBlock('ten')">+ Ten</button>
            <button class="block-add-btn" onclick="addBlock('one')">+ One</button>
            <button class="block-add-btn" onclick="clearBlocks()">Clear</button>
          </div>
          <div class="blocks-display" id="blocksDisplay"></div>
          <div class="blocks-total">Total: <span id="blocksTotal">0</span></div>
        </div>
      `;
    }

    function addBlock(type) {
      if (type === 'hundred') blocksHundreds++;
      else if (type === 'ten') blocksTens++;
      else blocksOnes++;
      renderBlocks();
    }

    function removeBlock(type) {
      if (type === 'hundred' && blocksHundreds > 0) blocksHundreds--;
      else if (type === 'ten' && blocksTens > 0) blocksTens--;
      else if (type === 'one' && blocksOnes > 0) blocksOnes--;
      renderBlocks();
    }

    function clearBlocks() {
      blocksHundreds = 0;
      blocksTens = 0;
      blocksOnes = 0;
      renderBlocks();
    }

    function renderBlocks() {
      const display = document.getElementById('blocksDisplay');
      let html = '';
      for (let i = 0; i < blocksHundreds; i++) {
        html += '<div class="block-hundred" onclick="removeBlock(\'hundred\')">100</div>';
      }
      for (let i = 0; i < blocksTens; i++) {
        html += '<div class="block-ten" onclick="removeBlock(\'ten\')">10</div>';
      }
      for (let i = 0; i < blocksOnes; i++) {
        html += '<div class="block-one" onclick="removeBlock(\'one\')">1</div>';
      }
      display.innerHTML = html;
      const total = blocksHundreds * 100 + blocksTens * 10 + blocksOnes;
      document.getElementById('blocksTotal').textContent = total;
    }

    function showCounter() {
      counterValue = 0;
      const area = document.getElementById('toolArea');
      area.innerHTML = `
        <div class="counter-tool">
          <p>Use this counter to count up or down!</p>
          <div class="counter-display" id="counterDisplay">0</div>
          <div class="counter-buttons">
            <button class="counter-btn" onclick="updateCounter(-100)">-100</button>
            <button class="counter-btn" onclick="updateCounter(-10)">-10</button>
            <button class="counter-btn" onclick="updateCounter(-1)">-1</button>
            <button class="counter-btn" onclick="updateCounter(1)">+1</button>
            <button class="counter-btn" onclick="updateCounter(10)">+10</button>
            <button class="counter-btn" onclick="updateCounter(100)">+100</button>
          </div>
          <br>
          <button class="counter-btn" onclick="resetCounter()">Reset</button>
          <button class="counter-btn" onclick="setCounterTo(num1)">Start at ${num1}</button>
        </div>
      `;
    }

    function updateCounter(amount) {
      counterValue += amount;
      document.getElementById('counterDisplay').textContent = counterValue;
    }

    function resetCounter() {
      counterValue = 0;
      document.getElementById('counterDisplay').textContent = 0;
    }

    function setCounterTo(val) {
      counterValue = val;
      document.getElementById('counterDisplay').textContent = val;
    }

    function showScratchPad() {
      const area = document.getElementById('toolArea');
      area.innerHTML = `
        <div class="scratch-pad">
          <p style="margin-bottom:8px; color:#888;">Write your work here!</p>
          <textarea placeholder="Show your work..."></textarea>
        </div>
      `;
    }

    function showHint() {
      const area = document.getElementById('toolArea');
      let hint = '';

      if (operator === '+') {
        const roundedNum2 = Math.round(num2 / 10) * 10;
        const diff = num2 - roundedNum2;
        if (Math.abs(diff) > 0 && Math.abs(diff) <= 5) {
          hint = `Try this: ${num1} + ${roundedNum2} = ${num1 + roundedNum2}, then ${diff > 0 ? 'add' : 'subtract'} ${Math.abs(diff)} more!`;
        } else {
          hint = `Start at ${num1} and count up ${num2} more!`;
        }
      } else if (operator === '-') {
        const roundedNum2 = Math.round(num2 / 10) * 10;
        const diff = num2 - roundedNum2;
        if (Math.abs(diff) > 0 && Math.abs(diff) <= 5) {
          hint = `Try this: ${num1} - ${roundedNum2} = ${num1 - roundedNum2}, then ${diff > 0 ? 'subtract' : 'add'} ${Math.abs(diff)} more!`;
        } else {
          hint = `Start at ${num1} and count back ${num2}!`;
        }
      }

      area.innerHTML = `<div class="hint-area">üí° ${hint}</div>`;
    }

    // Enter key to submit
    document.getElementById('answerInput').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') checkAnswer();
    });

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' && document.getElementById('nextBtn').style.display !== 'none') {
        newProblem();
      }
    });

    // Start the game!
    newProblem();
  </script>
</body>
</html>
